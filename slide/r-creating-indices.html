<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>SSPS4102Data Analytics in the Social Sciences</title>
    <meta charset="utf-8" />
    <meta name="author" content="Francesco Bailo" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# SSPS4102</br>Data Analytics in the Social Sciences
]
.subtitle[
## Week 06</br>Creating indices in R</br>(by averaging and PCA)
]
.author[
### Francesco Bailo
]
.institute[
### The University of Sydney
]
.date[
### Semester 1, 2023 (updated: 2023-03-22)
]

---


background-image: url(https://upload.wikimedia.org/wikipedia/en/6/6a/Logo_of_the_University_of_Sydney.svg)
background-size: 95%

&lt;style&gt;
pre {
  overflow-x: auto;
}
pre code {
  word-wrap: normal;
  white-space: pre;
}
&lt;/style&gt;



---

## Acknowledgement of Country

I would like to acknowledge the Traditional Owners of Australia and recognise their continuing connection to land, water and culture. The  University of Sydney is located on the land of the Gadigal people  of the Eora Nation. I pay my respects to their Elders, past and present.

---
background-image: url()
background-size: 100%

# Creating indices in R&lt;/br&gt;(by averaging and PCA)

---

## Why do we need an index?

A common situation for social scientists is to work with survey results administered through questionnaires, which contains dozens of questions. 

Yet it might be the c

Through surveys we try to capture and measure complex concepts. Yet, complex concepts usually can't be captured in a single, direct question. Instead, researchers *operationalise* the measurement of that concept through multiple questions. 

---

## Prepare your variables

Once you have selected the variables to use for the index, you must prepare them. In other words, you need to make sure that they can be treated as numerical (you are going to average them!) and that you exclude all the values that do not make numerical sense in your averaging. 

An example will hopefully help us understand the problem...

---

## Load the packages we will need


```r
library(dplyr)
library(haven)
```


### To install these packages (if you need to...)


```r
install.packages("dplyr")
install.packages("haven")
```

## Load the data 

You can download the data file itanes_2013.RData from Canvas. Then load it into your R session with


```r
# Path to file likely different on you computer
load("../data/itanes_2013.RData") 
# Note: You can also open and load an .RData file into your current R 
# session simply by clicking on it.
```

The data file itanes_2013.RData contains a single data frame, named `itanes_2013`, which was originally created reading the SPSS data file the responses to four questions of the *Italian National Election Survey 2013*, plus the `sex` of the respondent.


```r
head(itanes_2013)
```

```
## # A tibble: 6 × 6
##   sex        d38_1               d38_2               d38_3       d38_4   new_d…¹
##   &lt;dbl+lbl&gt;  &lt;dbl+lbl&gt;           &lt;dbl+lbl&gt;           &lt;dbl+lbl&gt;   &lt;dbl+l&gt; &lt;dbl+l&gt;
## 1 2 [Female] 1 [Not at all true] 4 [Completely true] 2 [Not qui… 2 [Not… 1 [Not…
## 2 2 [Female] 4 [Completely true] 4 [Completely true] 4 [Complet… 4 [Com… 4 [Com…
## 3 1 [Male]   4 [Completely true] 5 [Don't know]      3 [Fairly … 3 [Fai… 4 [Com…
## 4 1 [Male]   3 [Fairly true]     3 [Fairly true]     4 [Complet… 4 [Com… 3 [Fai…
## 5 1 [Male]   3 [Fairly true]     2 [Not quite true]  3 [Fairly … 3 [Fai… 3 [Fai…
## 6 1 [Male]   4 [Completely true] 4 [Completely true] 4 [Complet… 4 [Com… 4 [Com…
## # … with abbreviated variable name ¹​new_d38_1
```

---

## Inspect the data 

As we observe the variables are of type `dbl+lbl`. What is that?? 

For our purpose, we shouldn't worry to much about their label, as we can treat these variables as simple numerical variables (`double` or `dbl` for short) disregarding the information contained in their labels (or `lbl` for short).

But if we want to use them as categorical variables (that is, *factors*) instead of numerical we can transform them with the function `haven::as_factor()`. 

.pull-left[


```r
itanes_2013$d38_1[1]
```

```
## &lt;labelled&lt;double&gt;[1]&gt;: 38.1. PEOPLE LIKE ME DON'T HAVE ANY SAY IN WHAT THE GOVERNMENT DOES
## [1] 1
## 
## Labels:
##  value           label
##      1 Not at all true
##      2  Not quite true
##      3     Fairly true
##      4 Completely true
##      5      Don't know
##      6       No answer
```

]

.pull-right[


```r
haven::as_factor(itanes_2013$d38_1[1])
```

```
## [1] Not at all true
## attr(,"label")
## [1] 38.1. PEOPLE LIKE ME DON'T HAVE ANY SAY IN WHAT THE GOVERNMENT DOES
## 6 Levels: Not at all true Not quite true Fairly true ... No answer
```

]

---

## Codebook

This is the description of the four questions provided by the codebook. 

&gt; #### Section 10: Efficacy 
&gt; D38. For each of the following statements, could you tell me to what degree they are true, in your opinion?
&gt; * D38_1. People like me don’t have any say in what the government does. 
&gt; * D38_2. Sometimes politics and government seem so complicated that a person like me can’t really understand what’s going on. 
&gt; * D38_3. Usually, people we elect to the Parliament quickly lose touch with the people. 
&gt; * D38_4. Parties are only interested in people's votes, but not in their opinions. 
&gt;
&gt; [1] Not at all true [2] Not quite true [3] Fairly true [4] Completely true  [5] Don't know [6] No answer 

---

## Transforming our variables

Based on the codebook we note two things:

1. The four questions (D38_1, D38_2, D38_3 and D38_4) are all about *political efficacy*. Efficacy is an important concept in the political sciences, although not something you can directly ask to your respondents ("What is your sense of political efficacy on a scale from 1 to 10?" will hardly get any meaningful response...). Therefore a single dimension (here, political efficacy) has been measured with four distinct questions. 

2. All questions have the same set of possible answers (multiple-choices):

    * [1] Not at all true 
    * [2] Not quite true 
    * [3] Fairly true 
    * [4] Completely true 
    * [5] Don't know 
    * [6] No answer
    
    Where a value of `1` in the variable corresponds to the answer "Not at all true" and so on...
    
    
---

## Transforming our variables

We immediately realise that we can place these answers on a numerical scale as they are ordered and equally distanced (or so we can quite legitimately consider them).

So let's consider the 42nd respondent in our data frame (where `\(i = 42\)`, no particular reason to pick 42...). 

---


```r
itanes_2013$d38_1[42]
```

```
## &lt;labelled&lt;double&gt;[1]&gt;: 38.1. PEOPLE LIKE ME DON'T HAVE ANY SAY IN WHAT THE GOVERNMENT DOES
## [1] 3
## 
## Labels:
##  value           label
##      1 Not at all true
##      2  Not quite true
##      3     Fairly true
##      4 Completely true
##      5      Don't know
##      6       No answer
```


```r
itanes_2013$d38_2[42]
```

```
## &lt;labelled&lt;double&gt;[1]&gt;: 38.2. SOMETIMES POLITICS AND GOVERNMENT SEEM SO COMPLICATED THAT A PERSON LIKE M
## [1] 4
## 
## Labels:
##  value           label
##      1 Not at all true
##      2  Not quite true
##      3     Fairly true
##      4 Completely true
##      5      Don't know
##      6       No answer
```

---


```r
itanes_2013$d38_3[42]
```

```
## &lt;labelled&lt;double&gt;[1]&gt;: 38.3. PEOPLE WE ELECT TO THE PARLIAMENT QUICKLY LOSE TOUCH WITH THE PEOPLE
## [1] 4
## 
## Labels:
##  value           label
##      1 Not at all true
##      2  Not quite true
##      3     Fairly true
##      4 Completely true
##      5      Don't know
##      6       No answer
```


```r
itanes_2013$d38_4[42]
```

```
## &lt;labelled&lt;double&gt;[1]&gt;: 38.4. PARTIES ARE ONLY INTERESTED IN PEOPLE'S VOTES, BUT NOT IN THEIR OPINIONS
## [1] 3
## 
## Labels:
##  value           label
##      1 Not at all true
##      2  Not quite true
##      3     Fairly true
##      4 Completely true
##      5      Don't know
##      6       No answer
```

---

## Transforming our variables

Their answers to the four questions are respectively: 3, 4, 4 and 3. Since we can treat these variables as continuous, it makes total sense to sum them up 

.center[
`\(d38\_1_{42} + d38\_2_{42} + d38\_3_{42} + d38\_4_{42} = 14\)`
]

or to average them 

.center[
`\(\frac{d38\_1_{42} + d38\_2_{42} + d38\_3_{42} + d38\_4_{42}}{4} = 3.5\)`
]

Given these questions, the sum or the average can be effectively considered an efficacy *index*. 

And we can you this index to compare across our sample: `\(respondent_{42}\)` has expressed a *weaker*&lt;sup&gt;1&lt;/sup&gt; sense of political efficacy than `\(respondent_{1}\)` as

.center[
`\(\frac{d38\_1_{42} + d38\_2_{42} + d38\_3_{42} + d38\_4_{42}}{4} = 2.25\)`
]

.footnote[
[1] Look closely at questions and answers to understand the direction of your index. Here statements are negative ("PARTIES ARE ONLY INTERESTED IN PEOPLE'S VOTES...") and answers move from disagreement to agreement.
]

---


```r
itanes_2013 %&gt;%
  dplyr::rowwise() %&gt;%
  dplyr::mutate(index = mean(d38_1, d38_2, d38_3, d38_4))
```

```
## # A tibble: 1,508 × 7
## # Rowwise: 
##    sex        d38_1               d38_2            d38_3   d38_4   new_d…¹ index
##    &lt;dbl+lbl&gt;  &lt;dbl+lbl&gt;           &lt;dbl+lbl&gt;        &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl+l&gt; &lt;dbl&gt;
##  1 2 [Female] 1 [Not at all true] 4 [Completely t… 2 [Not… 2 [Not… 1 [Not…     1
##  2 2 [Female] 4 [Completely true] 4 [Completely t… 4 [Com… 4 [Com… 4 [Com…     4
##  3 1 [Male]   4 [Completely true] 5 [Don't know]   3 [Fai… 3 [Fai… 4 [Com…     4
##  4 1 [Male]   3 [Fairly true]     3 [Fairly true]  4 [Com… 4 [Com… 3 [Fai…     3
##  5 1 [Male]   3 [Fairly true]     2 [Not quite tr… 3 [Fai… 3 [Fai… 3 [Fai…     3
##  6 1 [Male]   4 [Completely true] 4 [Completely t… 4 [Com… 4 [Com… 4 [Com…     4
##  7 2 [Female] 4 [Completely true] 4 [Completely t… 4 [Com… 4 [Com… 4 [Com…     4
##  8 1 [Male]   4 [Completely true] 4 [Completely t… 4 [Com… 4 [Com… 4 [Com…     4
##  9 1 [Male]   2 [Not quite true]  2 [Not quite tr… 3 [Fai… 2 [Not… 2 [Not…     2
## 10 1 [Male]   4 [Completely true] 2 [Not quite tr… 4 [Com… 4 [Com… 4 [Com…     4
## # … with 1,498 more rows, and abbreviated variable name ¹​new_d38_1
```



    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
