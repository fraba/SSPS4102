<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>SSPS4102Data Analytics in the Social Sciences</title>
    <meta charset="utf-8" />
    <meta name="author" content="Francesco Bailo" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# SSPS4102</br>Data Analytics in the Social Sciences
]
.subtitle[
## Week 12</br>Logistic regression and advanced topics (Networks and Space)
]
.author[
### Francesco Bailo
]
.institute[
### The University of Sydney
]
.date[
### Semester 1, 2023 (updated: 2023-05-15)
]

---


background-image: url(https://upload.wikimedia.org/wikipedia/en/6/6a/Logo_of_the_University_of_Sydney.svg)
background-size: 95%

&lt;style&gt;
pre {
  overflow-x: auto;
}
pre code {
  word-wrap: normal;
  white-space: pre;
}
&lt;/style&gt;



---

## Acknowledgement of Country

I would like to acknowledge the Traditional Owners of Australia and recognise their continuing connection to land, water and culture. The  University of Sydney is located on the land of the Gadigal people  of the Eora Nation. I pay my respects to their Elders, past and present.


---

class: inverse, center, middle

# Logistic regression

---

## Why can't we just use a linear regression?

Linear regression assumes the dependent variable `\(Y_i\)` to be **quantitative**, that is, to be a variable scoped over a infinite, continuous range.   

`$$Y_i = \underbrace{\alpha}_{intercept} + \underbrace{\beta}_{slope} \times X_i + \underbrace{\epsilon_i}_{error\:term}$$`

Notably, the regression line which is the line that best fits the points (defined by the equation above), does not *begins* or *ends*. In fact, you can plug any number you can think of as value of `\(X\)` and obtained an estimated `\(\widehat{Y}\)`. 

This problem is called **extrapolation**. Extrapolation means that you get a trend from your data points, a regression line, and use it to predict outside of the range of your sample data and the "scope of the model". 

---

## Why can't we just use a linear regression?

.center[&lt;img src = 'https://imgs.xkcd.com/comics/extrapolating.png' width = '90%'&gt;&lt;/img&gt;]

Source: xkcd.com


---

## Why can't we just use a linear regression?

.center[&lt;img src = 'https://imgs.xkcd.com/comics/sustainable.png' width = '80%'&gt;&lt;/img&gt;]

Source: xkcd.com


---

## When is (probably) OK to use a linear regression

#### Variables that are continuous but can only assume positive values

`$$votes = \alpha + \beta_1 \times approval$$`
The model might also estimate that given a (very low) approval rate, the candidate is *likely* to receive a *negative* number of votes. This clearly doesn't make sense and yet a regression line can still be a very useful (therefore justifiable) approximation of what is going on in the real world.

#### Variables that are continuous but can only assume values in the range 0 to 1 (proportions).

Similarly to above, if we express `\(votes\)` as a proportion of total votes, it is still justifiable to use a regression line, even if doesn't make any sense to receive 105% of the votes (which is something the model can legitimately predict).  

---

## When is (probably) OK to use a linear regression

#### Variables that are continuous but can only assume values in the range 1 to 5 (e.g Likert scale answer).

If our dependent variable is a response of a survey with values limited to a small range, we can probably still treat it as a continuous variable (although the variable is more accurately an *ordinal* variable: categorical but ordered).  

---

## When is (definitely) NOT OK to use a linear regression


Suppose we have this data set (James et al., 2021, p. 131)

`\begin{equation}
    Y =
    \begin{cases}
      1 &amp; \text{if}\ stroke; \\
      2 &amp; \text{if}\ drug\ overdose; \\
      3 &amp; \text{if}\ epileptic\ seasure.
    \end{cases}
\end{equation}`

 Clearly, in this circumstance although the different cases are coded as a *quantitative* variable, they in fact are a *qualitative* response!
 
---

## Is it OK to use a linear regression with a binary outcome variable?

Although it is possible to do it - as the parameters the regression is going to estimate for you are *meaningful* in their interpretation (e.g. coefficients, p-values), it is more appropriate to treat the problem as a *classification* problem and use a **logistic regression** (more on this soon!). 
 
&gt; To summarize, there are at least two reasons **not to perform classification using a regression method**: 

&gt; * (a) a regression method cannot accommodate a qualitative response with more than two classes; 

&gt; * (b) a regression method will not provide meaningful estimates of `\(Pr(Y |X)\)`, even with just two classes. (James et al., 2021, p. 132)
 
---

## Logistic regression

* A logistic regression is model that works similarly to the linear regression. 

* But the key difference is that for any value of the independent variable `\(X\)`, the logistic regression will estimate (with a *logistic function*) outcomes that are *limited* to values between 0 and 1.

`$$log \left( \frac{p(X)}{1-p(X)} \right)  = \beta_0 + \beta_1 \times X$$`
* The left-hand side of the logistic regression equation, which we call *logit* or *log odds* is 

    * not anymore the *average change* in `\(Y\)` associated with a one-unit change in `\(X\)`; instead, 
    
    * in a logistic regression, a one-unit change in `\(X\)`, changes the *log odds* by `\(\beta_1\)`.

---

## Logistic regression

Let's consider some data from James et al., (2021, Chapter 4)...



&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; default &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; student &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; balance &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; income &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 309.518 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 35293.19 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 267.514 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 27364.87 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


&lt;img src="week-12_files/figure-html/unnamed-chunk-3-1.svg" width="100%" style="display: block; margin: auto;" /&gt;

---

## Logistic regression: Classification problem


```r
require(ISLR2) # For the `Default` data set

Default &lt;- 
  Default %&gt;%
* dplyr::mutate(default_prob = ifelse(default == "Yes", 1, 0))

ggplot(Default, aes(x = balance, y = default_prob, colour = default)) +
  scale_colour_manual(values=c("blue", "orange")) +
  geom_point()
```

&lt;img src="week-12_files/figure-html/unnamed-chunk-4-1.svg" width="50%" style="display: block; margin: auto;" /&gt;

---

### Prediction with linear regression and binary data



```r
lm_fit &lt;- lm(default_prob ~ balance,  data = Default)

*Default$lm_prediction &lt;- predict(lm_fit, newdata = Default)

ggplot(Default, aes(x = balance, y = default_prob, colour = default)) +
* geom_line(aes(y = lm_prediction), colour = 'red') +
  scale_colour_manual(values=c("blue", "orange")) +
  geom_point()
```

&lt;img src="week-12_files/figure-html/unnamed-chunk-5-1.svg" width="80%" style="display: block; margin: auto;" /&gt;

---

### Prediction with linear regression and binary data


&lt;img src="week-12_files/figure-html/unnamed-chunk-6-1.svg" width="80%" style="display: block; margin: auto;" /&gt;

* Clearly, since `\(Y\)` is binary, the regression line does here a poor job.

* The best line of fit, will never meet a single `default = 1` point! 

---

### Logistic regression in R


```r
glm_fit &lt;- 
* glm(default_prob ~ balance, data = Default, family = binomial)

glm_fit
```

```
## 
## Call:  glm(formula = default_prob ~ balance, family = binomial, data = Default)
## 
## Coefficients:
## (Intercept)      balance  
##  -10.651331     0.005499  
## 
## Degrees of Freedom: 9999 Total (i.e. Null);  9998 Residual
## Null Deviance:	    2921 
## Residual Deviance: 1596 	AIC: 1600
```


If the interpretation of the p-value doesn't change, the **interpretation of the coefficients is different**. Instead of a change in `\(Y\)` for a one-unit change in `\(X\)`, `\(\beta\)` is now a *log odds*, which we will need to transform to communicate 0-to-1 predictions!

---

### Logistic regression in R


```r
summary(glm_fit)
```

```
## 
## Call:
## glm(formula = default_prob ~ balance, family = binomial, data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2697  -0.1465  -0.0589  -0.0221   3.7589  
## 
## Coefficients:
##                Estimate  Std. Error z value            Pr(&gt;|z|)    
## (Intercept) -10.6513306   0.3611574  -29.49 &lt;0.0000000000000002 ***
## balance       0.0054989   0.0002204   24.95 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1596.5  on 9998  degrees of freedom
## AIC: 1600.5
## 
## Number of Fisher Scoring iterations: 8
```

---

### Prediction with logistic regression


```r
Default$glm_prediction &lt;- 
* predict(glm_fit, newdata = Default, type = "response")

ggplot(Default, aes(x = balance, y = default_prob, colour = default)) +
* geom_line(aes(y = glm_prediction), colour = 'red') +
  scale_colour_manual(values=c("blue", "orange")) +
  geom_point()
```



.pull-left[

&lt;img src="week-12_files/figure-html/unnamed-chunk-10-1.svg" width="100%" style="display: block; margin: auto;" /&gt;

]

.pull-right[
**Note**: `type = "response"` asks to output probabilities of the form `P(Y=1|X)`, so 0-to-1, instead of `log odds`.
]

---

#### Prediction with linear regression vs logistic regression

&lt;img src="week-12_files/figure-html/unnamed-chunk-11-1.svg" width="100%" style="display: block; margin: auto;" /&gt;

---

### Multiple logistic regression 

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; default &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; student &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; balance &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; income &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 399.1184 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 48889.99 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Yes &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 831.2419 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13703.00 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


```r
glm_fit &lt;- 
* glm(default_prob ~ balance + income + student,
      data = Default, family = binomial)
```

---


```r
summary(glm_fit)
```

```
## 
## Call:
## glm(formula = default_prob ~ balance + income + student, family = binomial, 
##     data = Default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4691  -0.1418  -0.0557  -0.0203   3.7383  
## 
## Coefficients:
##                  Estimate    Std. Error z value             Pr(&gt;|z|)    
## (Intercept) -10.869045196   0.492255516 -22.080 &lt; 0.0000000000000002 ***
## balance       0.005736505   0.000231895  24.738 &lt; 0.0000000000000002 ***
## income        0.000003033   0.000008203   0.370              0.71152    
## studentYes   -0.646775807   0.236252529  -2.738              0.00619 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1571.5  on 9996  degrees of freedom
## AIC: 1579.5
## 
## Number of Fisher Scoring iterations: 8
```

---

### Multiple logistic regression 

#### What is the probability of defaulting, given your balance and income if you are a student?


```r
predict(glm_fit, 
*       newdata =
*         data.frame(student = "Yes",
*                    balance = c(0, 1000, 1500, 2500),
*                    income = 30000),
*       type = "response")
```

```
##             1             2             3             4 
## 0.00001092094 0.00337388011 0.05624976878 0.94865344177
```

These values are predicted *probabilities* (because of `type = "response"`). 

I can therefore say, 

&gt; on average, a student with an income of $30,000 and a balance of $2500 has an estimated 94.86% probability of defaulting on their credit card debt. 

---

class: inverse, center, middle

# Network analysis

.center[&lt;img src = 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Internet_map_1024.jpg/768px-Internet_map_1024.jpg' width = '50%'&gt;&lt;/img&gt;]

---

## Network analysis

#### Relations, not attributes. Networks, not groups.

&gt; [S]ocial network analysts argue that causation is not located in the individual, but in the social structure. While people with similar attributes may behave similarly, explaining these similarities by pointing to common attributes misses the reality that individuals with common attributes often occupy similar positions in the social structure. 

&gt; That is, people with similar attributes frequently have similar social network positions. Their similar outcomes are caused by the **constraints**, **opportunities** and **perceptions** created by these similar network positions. (Marin &amp; Wellman, 2011, p. 13)


---

## Network data

* Network data is data about relationships (*edges*) among *vertices* (also known as *nodes*). 

* Everything can be a node. And everything can be an edge. 

.center[&lt;img src = '../img/newman-net-1.png' width = '80%'&gt;&lt;/img&gt;]

---

### Network data: The adjacency matrix

Let's assume I want to analyse this networks. How can I store the data? A common way to do it is with an adjacency matrix...

.center[&lt;img src = '../img/newman-net-2.png' width = '100%'&gt;&lt;/img&gt;]

Source: Newman, 2010, p. 111.

---

### Network data: The adjacency matrix

This is how we define each entry in the matrix:

`\begin{equation}
    A_{ij} =
    \begin{cases}
      1 &amp; \text{if there is an edge between vertices}\ i\ \text{and}\ j \text{,} \\
      0 &amp; \text{otherwise.}
    \end{cases}
\end{equation}`

And this is how the adjancency matrix for the simple network (a) we saw in the previous slide looks like


.center[&lt;img src = '../img/newman-net-3.png' width = '60%'&gt;&lt;/img&gt;]

Source: Newman, 2010, p. 111.

---

### Network data: The adjacency matrix

And this is how the adjacency matrix looks like for the more complex network (b) we saw before with multiple edges and self-edges. 

.center[&lt;img src = '../img/newman-net-4.png' width = '60%'&gt;&lt;/img&gt;]

Source: Newman, 2010, p. 112.


---

### Network data: The adjacency matrix

Let's get some network data (from Imai, 2017)


```r
florence &lt;- read.csv("../data/florentine.csv", row.names = "FAMILY")
```

Here how the first five columns/rows of our adjacency matrix look like.

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; ACCIAIUOL &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; ALBIZZI &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; BARBADORI &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; BISCHERI &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; CASTELLAN &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ACCIAIUOL &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ALBIZZI &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; BARBADORI &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; BISCHERI &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; CASTELLAN &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

A `1` in a cell of the matrix represents a marriage among the first five Florentine families.

In this case the network is **undirected** and the matrix is symmetric. Yet networks can be **directed** (e.g. Twitter followers).  

---


```r
library(igraph)

florence &lt;- 
  as.matrix(florence)

florence.g &lt;- 
* igraph::graph.adjacency(florence,
*                         mode = "undirected",
*                         diag = FALSE)

plot(florence.g)
```

&lt;img src="week-12_files/figure-html/unnamed-chunk-18-1.svg" width="50%" style="display: block; margin: auto;" /&gt;


---

# References

---

## References

* James, G., Witten, D., Hastie, T., &amp; Tibshirani, R. (2021). 4 Classification. In *An introduction to statistical learning: With applications in R*. Springer. https://link.springer.com/chapter/10.1007/978-1-0716-1418-1_4

* Marin, A., &amp; Wellman, B. (2011). *Social network analysis: An introduction*. In J. Scott &amp; P. J. Carrington (Eds.), The Sage handbook of social network analysis (pp. 11â€“25). SAGE Publications.

* Newman, M. E. J. (2010). *Networks: An introduction*. Oxford University Press.

* Imai, K. (2017). 5 Discovery. In *Quantitative social science: An introduction*. Princeton University Press. https://press.princeton.edu/books/paperback/9780691175461/quantitative-social-science




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
